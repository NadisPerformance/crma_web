{"ast":null,"code":"var __jsx = React.createElement;\nimport React from 'react';\nimport Select from 'react-select';\nimport { get_roles } from './queries';\nimport { Query } from 'react-apollo';\n\nclass SelectInput extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedId: 0\n    };\n    this.setSelectedId = this.setSelectedId.bind(this);\n    this.onChange = this.onChange.bind(this);\n  }\n\n  componentDidMount() {\n    const {\n      selectedId\n    } = this.props;\n\n    if (selectedId) {\n      this.state.selectedId = selectedId;\n      this.onChange(selectedId);\n    }\n  }\n\n  setSelectedId(value) {\n    this.setState({\n      selectedId: value\n    });\n    this.onChange(value);\n  }\n\n  onChange(value) {\n    if (this.props.onChange) this.props.onChange(value);\n  }\n\n  render() {\n    const {\n      selectedId\n    } = this.state;\n    return __jsx(Query, {\n      query: get_roles,\n      pollInterval: 3000\n    }, ({\n      loading,\n      error,\n      data\n    }) => {\n      if (loading) return __jsx(\"div\", null, \"Chargement en cours ...\");\n\n      if (error) {\n        console.log(error);\n        return __jsx(\"div\", null, \"Error\");\n      }\n\n      var options = []; //console.log(data.roles.edges)\n\n      var defaultValue;\n\n      for (var i = 0; i < data.roles.edges.length; i++) {\n        var role = data.roles.edges[i].node;\n        options.push({\n          value: role.id,\n          label: role.title\n        });\n        if (role.id == selectedId) defaultValue = {\n          value: role.id,\n          label: role.title\n        };\n      }\n\n      if (!this.state.selectedId && data.roles.edges[0]) this.setSelectedId(data.roles.edges[0].node.id); //console.log(options)\n\n      return __jsx(Select, {\n        className: \"basic-single\",\n        classNamePrefix: \"select\",\n        defaultValue: defaultValue,\n        isSearchable: true,\n        name: \"role\",\n        options: options,\n        onChange: ({\n          value\n        }) => this.setSelectedId(value)\n      });\n    });\n  }\n\n}\n\nconst styles = {\n  btnXs: {\n    padding: \".25rem .4rem\",\n    fontSize: \".875rem\",\n    lineHeight: 0.5,\n    borderRadius: \".2rem\"\n  }\n};\nexport default SelectInput;","map":null,"metadata":{},"sourceType":"module"}